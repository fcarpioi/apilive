{
  "info": {
    "_postman_id": "live-api-complete-2025-v3",
    "name": "Live API Complete - Todas las APIs (v4) - CON CLIPS",
    "description": "üöÄ COLECCI√ìN COMPLETA Y OPTIMIZADA del Live API Gateway\n\n‚úÖ NUEVAS FUNCIONALIDADES v4:\n‚Ä¢ üé¨ SPLITS CON CLIPS: Nuevos endpoints para consultar splits donde participantes tienen clips\n‚Ä¢ ÔøΩ CONTADOR DE COMPARTIR: Sistema completo de tracking de comparticiones con analytics\n‚Ä¢ ÔøΩüîç FILTRADO AVANZADO: participantId + type en /api/race-events\n‚Ä¢ üìÑ PAGINACI√ìN MEJORADA: offset + limit con metadatos completos\n‚Ä¢ üîî FCM OPTIMIZADO: Eliminada redundancia en tokens (70% menos storage)\n‚Ä¢ ÔøΩ NOTIFICACIONES SILENCIOSAS: Background sync sin molestar al usuario\n‚Ä¢ ÔøΩüìä METADATOS COMPLETOS: currentPage, totalPages, nextOffset, prevOffset\n‚Ä¢ üéØ FILTROS COMBINADOS: M√∫ltiples filtros simult√°neos\n‚Ä¢ ‚ö° PERFORMANCE: Consultas optimizadas por participante\n‚Ä¢ üë• SEGUIMIENTOS MIGRADOS: /api/follow y /api/unfollow con appId obligatorio\n\nüÜï ENDPOINTS CLIPS v4:\n‚Ä¢ üìã /api/races/{raceId}/events/{eventId}/participants/{participantId}/splits-with-clips/summary\n‚Ä¢ üìä /api/races/{raceId}/events/{eventId}/participants/{participantId}/splits-with-clips\n\nüÜï ENDPOINTS COMPARTIR v4:\n‚Ä¢ üì§ POST /api/share - Incrementar contador de comparticiones\n‚Ä¢ üìä GET /api/shares/count - Obtener estad√≠sticas de comparticiones (por participante o historia)\n\nüèóÔ∏è ESTRUCTURA: races/{raceId}/apps/{appId}/events/{eventId}\nüîß ENDPOINTS: 55+ APIs completamente documentadas\nüì± PUSH NOTIFICATIONS: Sistema FCM optimizado\nüé™ TESTING: Datos de prueba y ejemplos funcionales\n\n‚ö†Ô∏è MIGRACI√ìN IMPORTANTE: Los endpoints de seguimiento (/api/follow, /api/unfollow) y los nuevos endpoints de clips requieren appId como par√°metro obligatorio para usar la nueva estructura de base de datos.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "üè† Health Check",
      "item": [
        {
          "name": "API Root",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api"
              ]
            },
            "description": "Endpoint ra√≠z para verificar que la API est√° funcionando"
          }
        }
      ]
    },
    {
      "name": "üîç B√∫squeda (SIN ALGOLIA)",
      "item": [
        {
          "name": "Buscar Participantes - Por Nombre",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/search/participants?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&query=Carlos&limit=5",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "search",
                "participants"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "query",
                  "value": "Carlos"
                },
                {
                  "key": "limit",
                  "value": "5"
                }
              ]
            },
            "description": "B√∫squeda nativa en Firestore por nombre (SIN Algolia)"
          }
        },
        {
          "name": "Buscar Participantes - Por Dorsal",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/search/participants?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&query=101",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "search",
                "participants"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "query",
                  "value": "101"
                }
              ]
            },
            "description": "B√∫squeda por n√∫mero de dorsal exacto"
          }
        },
        {
          "name": "Buscar Participantes - Por Categor√≠a",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/search/participants?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&query=Elite",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "search",
                "participants"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "query",
                  "value": "Elite"
                }
              ]
            },
            "description": "B√∫squeda por categor√≠a exacta"
          }
        },
        {
          "name": "Buscar Participantes - Todos (Sin Query)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/search/participants?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "search",
                "participants"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Obtener todos los participantes sin filtro"
          }
        },
        {
          "name": "Buscar Participantes - Con Usuario (Seguimientos)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/search/participants?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&query=Carlos&userId={{userId}}&limit=5",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "search",
                "participants"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "query",
                  "value": "Carlos"
                },
                {
                  "key": "userId",
                  "value": "{{userId}}"
                },
                {
                  "key": "limit",
                  "value": "5"
                }
              ]
            },
            "description": "B√∫squeda con informaci√≥n de seguimientos del usuario"
          }
        }
      ]
    },
    {
      "name": "üì± Apps Feed Extended (Nueva Estructura)",
      "item": [
        {
          "name": "Feed Extended - Completo",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/feed/extended?appId={{appId}}&raceId={{raceId}}&eventId={{eventId}}&limit=20&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "feed",
                "extended"
              ],
              "query": [
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "Feed completo con nueva estructura races/apps/events"
          }
        },
        {
          "name": "Feed Extended - Historia Espec√≠fica",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/feed/extended?appId={{appId}}&raceId={{raceId}}&eventId={{eventId}}&storyId={{storyId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "feed",
                "extended"
              ],
              "query": [
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "storyId",
                  "value": "{{storyId}}"
                }
              ]
            },
            "description": "Obtener detalles de una historia espec√≠fica"
          }
        },
        {
          "name": "üÜï Feed Extended - Participante Espec√≠fico",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/feed/extended?appId={{appId}}&raceId={{raceId}}&eventId={{eventId}}&participantId={{participantId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "feed",
                "extended"
              ],
              "query": [
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}"
                }
              ]
            },
            "description": "üÜï NUEVO: Obtener todas las historias de un participante espec√≠fico usando su ID"
          }
        },
        {
          "name": "üÜï Feed Extended - Con userId (Seguidos)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/feed/extended?appId={{appId}}&raceId={{raceId}}&eventId={{eventId}}&userId={{userId}}&limit=5",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "feed",
                "extended"
              ],
              "query": [
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "userId",
                  "value": "{{userId}}"
                },
                {
                  "key": "limit",
                  "value": "5"
                }
              ]
            },
            "description": "üÜï ACTUALIZADO: Filtrar historias por participantes seguidos usando userId. Si el usuario no sigue a nadie, devuelve todas las historias."
          }
        },
        {
          "name": "Feed Extended - Con Usuario (Seguidos)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/feed/extended?appId={{appId}}&raceId={{raceId}}&eventId={{eventId}}&userId={{userId}}&limit=10",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "feed",
                "extended"
              ],
              "query": [
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "userId",
                  "value": "{{userId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            }
          },
          "description": "Feed con historias de participantes seguidos"
        }
      ]
    },
    {
      "name": "üó∫Ô∏è GPX Maps",
      "item": [
        {
          "name": "List GPX Maps - by app",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/gpx-maps?raceId={{raceId}}&appId={{appId}}&limit=100",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "gpx-maps"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "limit",
                  "value": "100"
                }
              ]
            },
            "description": "Listar mapas GPX asociados a una app (opcional por eventId). Devuelve objetos con id, widgetId, title, updatedAt y gpxData.{bounds, routePoints, waypoints}."
          },
          "response": [
            {
              "name": "Example - success",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/apps/gpx-maps?raceId={{raceId}}&appId={{appId}}&limit=100",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "apps",
                    "gpx-maps"
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "body": "{\"total\":1,\"maps\":[{\"id\":\"1767804113908\",\"widgetId\":\"1767804113908\",\"title\":\"Race Map\",\"updatedAt\":\"2026-01-07T17:08:05.246Z\",\"gpxData\":{\"bounds\":{\"minLon\":-3.703889,\"maxLat\":40.419944,\"minLat\":40.406944,\"maxLon\":-3.670833},\"routePoints\":[{\"lat\":40.419944,\"lon\":-3.688889},{\"lat\":40.418611,\"lon\":-3.686944}],\"waypoints\":[{\"lat\":40.406944,\"lon\":-3.690278,\"name\":\"Aid Station 30K - Prado Museum\",\"desc\":\"Water, electrolytes, and bananas at 30 km mark\",\"icon\":\"water\"},{\"lat\":40.419944,\"lon\":-3.688889,\"name\":\"Start - Puerta de Alcal√°\",\"desc\":\"Starting line at Puerta de Alcal√°\",\"icon\":\"start\"}]}}]"
            }
          ],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200', function () { pm.response.to.have.status(200); });",
                  "pm.test('Response has maps array', function () { var json = pm.response.json(); pm.expect(json).to.have.property('maps'); pm.expect(Array.isArray(json.maps)).to.be.true; });"
                ]
              }
            }
          ]
        },
        {
          "name": "List GPX Maps - by event",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/gpx-maps?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=100",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "gpx-maps"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "100"
                }
              ]
            },
            "description": "Listar mapas GPX filtrados por evento (eventId opcional)."
          },
          "response": [
            {
              "name": "Example - success",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/apps/gpx-maps?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=100",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "api",
                    "apps",
                    "gpx-maps"
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [],
              "body": "{\"total\":1,\"maps\":[{\"id\":\"1767804113908\",\"widgetId\":\"1767804113908\",\"title\":\"Race Map\",\"updatedAt\":\"2026-01-07T17:08:05.246Z\",\"gpxData\":{\"bounds\":{\"minLon\":-3.703889,\"maxLat\":40.419944,\"minLat\":40.406944,\"maxLon\":-3.670833},\"routePoints\":[{\"lat\":40.419944,\"lon\":-3.688889},{\"lat\":40.418611,\"lon\":-3.686944}],\"waypoints\":[{\"lat\":40.406944,\"lon\":-3.690278,\"name\":\"Aid Station 30K - Prado Museum\",\"desc\":\"Water, electrolytes, and bananas at 30 km mark\",\"icon\":\"water\"},{\"lat\":40.419944,\"lon\":-3.688889,\"name\":\"Start - Puerta de Alcal√°\",\"desc\":\"Starting line at Puerta de Alcal√°\",\"icon\":\"start\"}]}}]"
            }
          ],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code is 200', function () { pm.response.to.have.status(200); });",
                  "pm.test('Response has maps array', function () { var json = pm.response.json(); pm.expect(json).to.have.property('maps'); pm.expect(Array.isArray(json.maps)).to.be.true; });"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "üë§ Participantes",
      "item": [
        {
          "name": "Get Participante (Nueva Estructura)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/participant?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&participantId={{participantId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "participant"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}"
                }
              ]
            },
            "description": "Obtener participante con splits en nueva estructura"
          }
        },
        {
          "name": "Get Participante (Con Fallback)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/participant?raceId={{raceId}}&eventId={{eventId}}&participantId={{participantId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "participant"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}"
                }
              ]
            },
            "description": "Endpoint con fallback a estructura antigua"
          }
        },
        {
          "name": "Leaderboard (Overall/Gender/Category)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/leaderboard?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&type=overall&limit=20&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "leaderboard"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}",
                  "description": "ID de la carrera"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}",
                  "description": "ID de la app"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}",
                  "description": "ID del evento"
                },
                {
                  "key": "type",
                  "value": "overall",
                  "description": "overall | gender | category (sin gender/category agrupa todos los grupos)"
                },
                {
                  "key": "gender",
                  "value": "",
                  "description": "Opcional si type=gender. Si no se env√≠a, devuelve todos los g√©neros agrupados."
                },
                {
                  "key": "category",
                  "value": "",
                  "description": "Opcional si type=category. Si no se env√≠a, devuelve todas las categor√≠as agrupadas."
                },
                {
                  "key": "split",
                  "value": "",
                  "description": "Opcional: split/ubicaci√≥n (ej. 10K, Media). Si no, usa el split m√°s avanzado disponible."
                },
                {
                  "key": "limit",
                  "value": "20",
                  "description": "L√≠mite por grupo (para overall aplica al total)."
                },
                {
                  "key": "offset",
                  "value": "0",
                  "description": "Desplazamiento/paginaci√≥n (aplica por grupo en gender/category)."
                }
              ]
            },
            "description": "Leaderboard calculado con rankings de Copernico.\n- type=overall: lista √∫nica por posici√≥n general.\n- type=gender: agrupa por g√©nero (male/female/...). Si no env√≠as gender, devuelve todos los grupos.\n- type=category: agrupa por categor√≠a. Si no env√≠as category, devuelve todos los grupos.\n- split opcional (ej. 10K); si no, usa el split m√°s avanzado.\n- limit/offset: paginaci√≥n (offset por grupo en gender/category)."
          }
        }
      ]
    },
    {
      "name": "Clips de Video",
      "item": [
        {
          "name": "üé¨ Splits con Clips - Resumen",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/races/{{raceId}}/events/{{eventId}}/participants/{{participantId}}/splits-with-clips/summary?appId={{appId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "races",
                "{{raceId}}",
                "events",
                "{{eventId}}",
                "participants",
                "{{participantId}}",
                "splits-with-clips",
                "summary"
              ],
              "query": [
                {
                  "key": "appId",
                  "value": "{{appId}}",
                  "description": "ID de la app (REQUERIDO)"
                }
              ],
              "variable": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}",
                  "description": "ID de la carrera"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}",
                  "description": "ID del evento"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}",
                  "description": "ID del participante"
                }
              ]
            },
            "description": "üÜï NUEVO: Obtener lista simple de splits donde el participante tiene clips de video.\n\n‚úÖ RESPUESTA:\n{\n  \"success\": true,\n  \"participantId\": \"1ZZCB42Y\",\n  \"totalSplits\": 1,\n  \"splitsWithClips\": [\"Media\"]\n}\n\nüéØ CASOS DE USO:\n‚Ä¢ Mostrar progreso del atleta en app m√≥vil\n‚Ä¢ Verificar cobertura de clips por participante\n‚Ä¢ Dashboard de analytics\n\n‚ö†Ô∏è REQUIERE: appId obligatorio (estructura nueva √∫nicamente)"
          }
        },
        {
          "name": "üé¨ Splits con Clips - Detallado",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/races/{{raceId}}/events/{{eventId}}/participants/{{participantId}}/splits-with-clips?appId={{appId}}&detailed=true",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "races",
                "{{raceId}}",
                "events",
                "{{eventId}}",
                "participants",
                "{{participantId}}",
                "splits-with-clips"
              ],
              "query": [
                {
                  "key": "appId",
                  "value": "{{appId}}",
                  "description": "ID de la app (REQUERIDO)"
                },
                {
                  "key": "detailed",
                  "value": "true",
                  "description": "Incluir detalles completos de clips (opcional, default: false)"
                }
              ],
              "variable": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}",
                  "description": "ID de la carrera"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}",
                  "description": "ID del evento"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}",
                  "description": "ID del participante"
                }
              ]
            },
            "description": "üÜï NUEVO: Obtener informaci√≥n detallada de splits con clips, incluyendo URLs y metadatos.\n\n‚úÖ RESPUESTA DETALLADA:\n{\n  \"success\": true,\n  \"participantId\": \"1ZZCB42Y\",\n  \"totalSplits\": 1,\n  \"totalClips\": 1,\n  \"splitsWithClips\": [\"Media\"],\n  \"detailedSplits\": [\n    {\n      \"splitName\": \"Media\",\n      \"splitIndex\": 3,\n      \"clipCount\": 1,\n      \"clips\": [\n        {\n          \"id\": \"Media\",\n          \"clipUrl\": \"https://stream.mux.com/ibEhjKrZZoiD6eRtvSpLFWYb601HxGnyov5CimXkKzSQ.m3u8\",\n          \"timestamp\": \"2025-12-14T08:38:10.898Z\",\n          \"generatedAt\": \"2025-12-29T20:02:12.141Z\"\n        }\n      ]\n    }\n  ]\n}\n\nüéØ CASOS DE USO:\n‚Ä¢ Galer√≠a de clips por participante\n‚Ä¢ Reproducci√≥n de videos por splits\n‚Ä¢ An√°lisis detallado de cobertura\n‚Ä¢ Descarga de clips espec√≠ficos\n\n‚ö†Ô∏è REQUIERE: appId obligatorio (estructura nueva √∫nicamente)"
          }
        }
      ]
    },
    {
      "name": "üèÜ Sponsors",
      "item": [
        {
          "name": "Get All Sponsors",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/sponsors?raceId={{raceId}}&appId={{appId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "sponsors"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                }
              ]
            },
            "description": "Obtener lista de todos los sponsors"
          }
        },
        {
          "name": "Get Sponsor Details",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/sponsors/{{sponsorId}}?raceId={{raceId}}&appId={{appId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "sponsors",
                "{{sponsorId}}"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                }
              ]
            },
            "description": "Obtener detalles de un sponsor espec√≠fico"
          }
        },
        {
          "name": "Get Sponsor Stories",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/sponsors/{{sponsorId}}/stories?raceId={{raceId}}&appId={{appId}}&limit=10",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "sponsors",
                "{{sponsorId}}",
                "stories"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Obtener stories de un sponsor espec√≠fico"
          }
        }
      ]
    },
    {
      "name": "üèÅ Race Events (MEJORADO CON FILTROS Y PAGINACI√ìN)",
      "item": [
        {
          "name": "‚úÖ Get All Stories - Paginaci√≥n B√°sica",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "‚úÖ MEJORADO: Obtener todas las stories con paginaci√≥n. Incluye informaci√≥n completa de paginaci√≥n (currentPage, totalPages, nextOffset, prevOffset) y filtros aplicados."
          }
        },
        {
          "name": "üÜï Get Stories - Participante Espec√≠fico",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&participantId={{participantId}}&limit=5&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}"
                },
                {
                  "key": "limit",
                  "value": "5"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "üÜï NUEVO: Filtrar stories por participante espec√≠fico. Optimizado para obtener solo las stories de un participante, reduciendo consultas y mejorando performance."
          }
        },
        {
          "name": "‚úÖ Get Started Stories - Con Paginaci√≥n",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&type=ATHLETE_STARTED&limit=10&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "type",
                  "value": "ATHLETE_STARTED"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "‚úÖ MEJORADO: Filtrar por tipo ATHLETE_STARTED con paginaci√≥n completa. Incluye metadatos de filtros aplicados y navegaci√≥n de p√°ginas."
          }
        },
        {
          "name": "‚úÖ Get Checkpoint Stories - Con Paginaci√≥n",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&type=ATHLETE_CROSSED_TIMING_SPLIT&limit=10&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "type",
                  "value": "ATHLETE_CROSSED_TIMING_SPLIT"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "‚úÖ MEJORADO: Filtrar por checkpoints intermedios con paginaci√≥n. Ideal para ver progreso de participantes en puntos espec√≠ficos de la carrera."
          }
        },
        {
          "name": "‚úÖ Get Finished Stories - Con Paginaci√≥n",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&type=ATHLETE_FINISHED&limit=10&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "type",
                  "value": "ATHLETE_FINISHED"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "‚úÖ MEJORADO: Filtrar por stories de meta/finalizaci√≥n con paginaci√≥n. Perfecto para ver qui√©n ha terminado la carrera."
          }
        },
        {
          "name": "üÜï Filtros Combinados - Tipo + Participante",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&type=ATHLETE_STARTED&participantId={{participantId}}&limit=5&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "type",
                  "value": "ATHLETE_STARTED"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}"
                },
                {
                  "key": "limit",
                  "value": "5"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "üÜï NUEVO: Combinar filtros por tipo y participante espec√≠fico. Ejemplo: solo stories de salida de un participante espec√≠fico."
          }
        },
        {
          "name": "üìÑ Paginaci√≥n - P√°gina 2 (Ejemplo)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset=10",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "10"
                }
              ]
            },
            "description": "üìÑ EJEMPLO DE PAGINACI√ìN: Obtener p√°gina 2 (registros 11-20). Para navegar: P√°gina 1 (offset=0), P√°gina 2 (offset=10), P√°gina 3 (offset=20), etc."
          }
        },
        {
          "name": "üìä Paginaci√≥n Avanzada - 200 registros ejemplo",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset=40",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "40"
                }
              ]
            },
            "description": "üìä EJEMPLO AVANZADO: P√°gina 5 de 200 registros (offset=40 = p√°gina 5 con 10 por p√°gina). F√≥rmula: offset = (p√°gina - 1) √ó limit. Respuesta incluye nextOffset y prevOffset para navegaci√≥n autom√°tica."
          }
        },
        {
          "name": "üÜï Get Race with Events and Splits",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/races/{{raceId}}/apps/{{appId}}/events_splits",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "races",
                "{{raceId}}",
                "apps",
                "{{appId}}",
                "events_splits"
              ]
            },
            "description": "üéØ NUEVO ENDPOINT: Obtener informaci√≥n completa de una carrera espec√≠fica, incluyendo todos sus eventos con splits y estados actuales.\\n\\nüì• VARIABLES CONFIGURADAS POR DEFECTO:\\n- raceId: {{raceId}} = 26dc137a-34e2-44a0-918b-a5af620cf281\\n- appId: {{appId}} = Qmhfu2mx669sRaDe2LOg (Gij√≥n 2025)\\n\\nüì§ RESPUESTA CON DATOS POR DEFECTO:\\n- race: Sin nombre (cronochip, UTC)\\n- app: Gij√≥n 2025\\n- events: 3 eventos (Invitados, Montju√Øc-Tibidabo, Workflows)\\n- summary: 3 eventos totales, 7 splits, estados calculados\\n\\nüö¶ ESTADOS DE EVENTOS:\\n- NOT_STARTED: !wavesStarted && !finished\\n- IN_PROGRESS: wavesStarted && !finished\\n- FINISHED: finished === true\\n\\n‚úÖ CASOS DE ERROR:\\n- 404 RACE_NOT_FOUND: Race no encontrada\\n- 404 APP_NOT_FOUND: App no encontrada en la race\\n- 500 INTERNAL_ERROR: Error interno del servidor\\n\\nüß™ PROBADO Y FUNCIONANDO: Usa variables de colecci√≥n configuradas"
          }
        },
        {
          "name": "üîß HARDCODED - Race Events Splits (GUARANTEED WORKING)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "https://liveapigateway-3rt3xwiooa-uc.a.run.app/api/races/26dc137a-34e2-44a0-918b-a5af620cf281/apps/Qmhfu2mx669sRaDe2LOg/events_splits",
              "protocol": "https",
              "host": [
                "liveapigateway-3rt3xwiooa-uc",
                "a",
                "run",
                "app"
              ],
              "path": [
                "api",
                "races",
                "26dc137a-34e2-44a0-918b-a5af620cf281",
                "apps",
                "Qmhfu2mx669sRaDe2LOg",
                "events_splits"
              ]
            },
            "description": "üîß VERSI√ìN HARDCODEADA - GARANTIZADA PARA FUNCIONAR\\n\\nüìç URL COMPLETA SIN VARIABLES:\\nhttps://liveapigateway-3rt3xwiooa-uc.a.run.app/api/races/26dc137a-34e2-44a0-918b-a5af620cf281/apps/Qmhfu2mx669sRaDe2LOg/events_splits\\n\\n‚úÖ DATOS HARDCODEADOS:\\n- raceId: 26dc137a-34e2-44a0-918b-a5af620cf281\\n- appId: Qmhfu2mx669sRaDe2LOg\\n\\nüéØ USA ESTA VERSI√ìN SI:\\n- Las variables no funcionan\\n- Hay problemas de cache en Postman\\n- Necesitas una prueba r√°pida garantizada\\n\\nüìä RESPUESTA ESPERADA:\\n- success: true\\n- 3 eventos (Invitados, Montju√Øc-Tibidabo, Workflows)\\n- 7 splits totales\\n- Estados calculados autom√°ticamente"
          }
        }
      ]
    },
    {
      "name": "üìÑ EJEMPLOS DE PAGINACI√ìN (Race Events)",
      "item": [
        {
          "name": "üìö GU√çA: C√≥mo paginar 200 registros (10 por p√°gina)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "üìö GU√çA COMPLETA DE PAGINACI√ìN:\n\nüéØ EJEMPLO: 200 registros, 10 por p√°gina = 20 p√°ginas\n\nüìÑ F√ìRMULA: offset = (p√°gina - 1) √ó limit\n\nüìä NAVEGACI√ìN:\n‚Ä¢ P√°gina 1: offset=0 (registros 1-10)\n‚Ä¢ P√°gina 2: offset=10 (registros 11-20)\n‚Ä¢ P√°gina 3: offset=20 (registros 21-30)\n‚Ä¢ P√°gina 5: offset=40 (registros 41-50)\n‚Ä¢ P√°gina 10: offset=90 (registros 91-100)\n‚Ä¢ P√°gina 20: offset=190 (registros 191-200)\n\n‚úÖ RESPUESTA INCLUYE:\n‚Ä¢ pagination.currentPage: P√°gina actual\n‚Ä¢ pagination.totalPages: Total de p√°ginas\n‚Ä¢ pagination.nextOffset: Offset para p√°gina siguiente\n‚Ä¢ pagination.prevOffset: Offset para p√°gina anterior\n‚Ä¢ pagination.hasMore: Si hay m√°s p√°ginas\n\nüîß PAR√ÅMETROS:\n‚Ä¢ limit: Registros por p√°gina (m√°x 100)\n‚Ä¢ offset: Registros a saltar desde el inicio"
          }
        },
        {
          "name": "P√°gina 1 (registros 1-10)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "P√°gina 1: offset=0, registros 1-10"
          }
        },
        {
          "name": "P√°gina 5 (registros 41-50)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset=40",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "40"
                }
              ]
            },
            "description": "P√°gina 5: offset=40, registros 41-50"
          }
        },
        {
          "name": "P√°gina 10 (registros 91-100)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset=90",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "90"
                }
              ]
            },
            "description": "P√°gina 10: offset=90, registros 91-100"
          }
        },
        {
          "name": "P√°gina 20 (registros 191-200)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset=190",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "190"
                }
              ]
            },
            "description": "P√°gina 20 (√∫ltima): offset=190, registros 191-200"
          }
        },
        {
          "name": "üîÑ Navegaci√≥n Autom√°tica - Usar nextOffset",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset={{nextOffset}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "{{nextOffset}}"
                }
              ]
            },
            "description": "üîÑ NAVEGACI√ìN AUTOM√ÅTICA: Usar el valor 'nextOffset' de la respuesta anterior para ir a la siguiente p√°gina autom√°ticamente. Crear variable {{nextOffset}} y actualizar con cada respuesta."
          }
        }
      ]
    },
    {
      "name": "üë• Social (Seguimientos & Likes)",
      "item": [
        {
          "name": "Get User Following",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/following?userId={{userId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "users",
                "following"
              ],
              "query": [
                {
                  "key": "userId",
                  "value": "{{userId}}"
                }
              ]
            },
            "description": "Obtener lista de participantes seguidos por un usuario"
          }
        },
        {
          "name": "Get User Following Count",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/following/count?userId={{userId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "users",
                "following",
                "count"
              ],
              "query": [
                {
                  "key": "userId",
                  "value": "{{userId}}"
                }
              ]
            },
            "description": "Contar participantes seguidos por un usuario"
          }
        },
        {
          "name": "Seguir Participante",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"followerId\": \"{{userId}}\",\n  \"followingId\": \"{{participantId}}\",\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/follow",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "follow"
              ]
            },
            "description": "Seguir a un participante espec√≠fico. MIGRADO para nueva estructura races/apps/events. Requiere appId como par√°metro obligatorio.\n\nActualiza followsCount en el participante: +1 al seguir, -1 al dejar de seguir (m√≠nimo 0)."
          }
        },
        {
          "name": "Dejar de Seguir Participante",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"followerId\": \"{{userId}}\",\n  \"followingId\": \"{{participantId}}\",\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/unfollow",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "unfollow"
              ]
            },
            "description": "Dejar de seguir a un participante espec√≠fico. MIGRADO para nueva estructura races/apps/events. Requiere appId como par√°metro obligatorio.\n\nActualiza followsCount en el participante: +1 al seguir, -1 al dejar de seguir (m√≠nimo 0)."
          }
        },
        {
          "name": "Dar Like a Historia",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\",\n  \"participantId\": \"{{participantId}}\",\n  \"storyId\": \"{{storyId}}\",\n  \"userId\": \"{{userId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/like",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "like"
              ]
            },
            "description": "Agregar un like a una historia espec√≠fica. MIGRADO para nueva estructura races/apps/events."
          }
        },
        {
          "name": "Quitar Like de Historia",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\",\n  \"participantId\": \"{{participantId}}\",\n  \"storyId\": \"{{storyId}}\",\n  \"userId\": \"{{userId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/unlike",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "unlike"
              ]
            },
            "description": "Eliminar un like de una historia espec√≠fica. Usa la nueva estructura races/apps/events."
          }
        },
        {
          "name": "Contar Likes de Participante",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/likes/count?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&participantId={{participantId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "likes",
                "count"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}"
                }
              ]
            },
            "description": "Obtener el total de likes de todas las historias de un participante. MIGRADO para nueva estructura races/apps/events."
          }
        }
      ]
    },
    {
      "name": "üë§ Gesti√≥n de Usuarios",
      "item": [
        {
          "name": "Crear Usuario",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"user-test-001\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "users"
              ]
            },
            "description": "Crear un nuevo usuario con un ID espec√≠fico. Solo requiere userId como par√°metro inicial."
          }
        },
        {
          "name": "Listar Usuarios",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users?limit=10&offset=0&status=active",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "users"
              ],
              "query": [
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                },
                {
                  "key": "status",
                  "value": "active"
                }
              ]
            },
            "description": "Obtener lista paginada de usuarios con filtros opcionales."
          }
        },
        {
          "name": "Buscar Usuarios",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users?search=juan&limit=5",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "users"
              ],
              "query": [
                {
                  "key": "search",
                  "value": "juan"
                },
                {
                  "key": "limit",
                  "value": "5"
                }
              ]
            },
            "description": "Buscar usuarios por nombre, email o ID."
          }
        },
        {
          "name": "Obtener Perfil de Usuario",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/user/profile?userId={{userId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "user",
                "profile"
              ],
              "query": [
                {
                  "key": "userId",
                  "value": "{{userId}}"
                }
              ]
            },
            "description": "Obtener el perfil completo de un usuario espec√≠fico."
          }
        },
        {
          "name": "Actualizar Usuario",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"profile\": {\n    \"name\": \"Juan\",\n    \"lastName\": \"P√©rez\",\n    \"email\": \"juan.perez@email.com\",\n    \"phone\": \"+34612345678\",\n    \"birthdate\": \"1990-05-15\",\n    \"gender\": \"male\",\n    \"preferences\": {\n      \"notifications\": true,\n      \"language\": \"es\"\n    }\n  },\n  \"status\": \"active\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users/{{userId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "users",
                "{{userId}}"
              ]
            },
            "description": "Actualizar informaci√≥n completa de un usuario existente."
          }
        },
        {
          "name": "Eliminar Usuario",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/{{userId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "users",
                "{{userId}}"
              ]
            },
            "description": "Eliminar usuario (soft delete). Marca como inactivo y limpia datos relacionados."
          }
        }
      ]
    },
    {
      "name": "üì± Apps & Companies",
      "item": [
        {
          "name": "Get All Apps",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps"
              ]
            },
            "description": "Obtener todas las aplicaciones"
          }
        },
        {
          "name": "Get Apps by Company",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps?idcompany={{companyId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps"
              ],
              "query": [
                {
                  "key": "idcompany",
                  "value": "{{companyId}}"
                }
              ]
            },
            "description": "Obtener apps filtradas por company ID"
          }
        },
        {
          "name": "Get Apps by Bundle ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps?bundleId={{bundleId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps"
              ],
              "query": [
                {
                  "key": "bundleId",
                  "value": "{{bundleId}}"
                }
              ]
            },
            "description": "Obtener apps filtradas por bundle ID"
          }
        },
        {
          "name": "Get Companies",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/companies",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "companies"
              ]
            },
            "description": "Obtener todas las companies (√∫ltimos 15 d√≠as)"
          }
        }
      ]
    },
    {
      "name": "‚öôÔ∏è Config (Nueva API)",
      "item": [
        {
          "name": "Get Config by Bundle ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/config?bundleId={{bundleId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "config"
              ],
              "query": [
                {
                  "key": "bundleId",
                  "value": "{{bundleId}}"
                }
              ]
            },
            "description": "Obtener configuraci√≥n completa de app con eventos y media por Bundle ID"
          }
        },
        {
          "name": "Get Config by Race ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/config?raceId={{raceId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "config"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                }
              ]
            },
            "description": "Obtener configuraci√≥n completa de app con eventos y media por Race ID"
          }
        },
        {
          "name": "Get Config by Race Name",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/config?raceName={{raceName}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "config"
              ],
              "query": [
                {
                  "key": "raceName",
                  "value": "{{raceName}}"
                }
              ]
            },
            "description": "Obtener configuraci√≥n completa de app con eventos y media por Race Name"
          }
        }
      ]
    },
    {
      "name": "üì§ Upload & Media",
      "item": [
        {
          "name": "Generate Upload URL",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\",\n  \"participantId\": \"{{participantId}}\",\n  \"fileName\": \"video.mp4\",\n  \"contentType\": \"video/mp4\",\n  \"description\": \"Video de prueba\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/generateUploadUrl",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "generateUploadUrl"
              ]
            },
            "description": "Generar URL prefirmada para subir archivos a Firebase Storage"
          }
        },
        {
          "name": "Download and Upload from URL",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"url\": \"https://example.com/video.mp4\",\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\",\n  \"participantId\": \"{{participantId}}\",\n  \"description\": \"Video descargado desde URL\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/downloadAndUpload",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "downloadAndUpload"
              ]
            },
            "description": "Descargar archivo desde URL y subirlo a Firebase Storage"
          }
        },
        {
          "name": "üÜï Upload Story (MIGRATED)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"apiKey\": \"9a6cf30847d9d4c1a9612270bc7dfa500cf557267d7cbbfe656034122fbe2ea0\",\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\",\n  \"participantId\": \"{{participantId}}\",\n  \"fileUrl\": \"https://example.com/video.mp4\",\n  \"description\": \"Video de prueba migrado\",\n  \"originType\": \"webhook-test\",\n  \"date\": \"2024-01-15T10:30:00.000Z\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/uploadFullFlow",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "uploadFullFlow"
              ]
            },
            "description": "üÜï MIGRADO: Upload story con nueva estructura races/{raceId}/apps/{appId}/events/{eventId}/participants/{participantId}/stories"
          }
        },
        {
          "name": "üÜï Upload Media (MIGRATED)",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}",
                  "type": "text"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}",
                  "type": "text"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}",
                  "type": "text"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}",
                  "type": "text"
                },
                {
                  "key": "description",
                  "value": "Media de prueba migrado",
                  "type": "text"
                },
                {
                  "key": "file",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/uploadMedia",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "uploadMedia"
              ]
            },
            "description": "üÜï MIGRADO: Upload media con nueva estructura races/{raceId}/apps/{appId}/events/{eventId}/participants/{participantId}/media"
          }
        }
      ]
    },
    {
      "name": "üîî Webhooks & Checkpoints",
      "item": [
        {
          "name": "Checkpoint Participant (Copernico Webhook)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "apiKey",
                "value": "{{apiKey}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"competitionId\": \"{{raceId}}\",\n  \"copernicoId\": \"{{copernicoId}}\",\n  \"type\": \"detection\",\n  \"participantId\": \"{{participantId}}\",\n  \"rawTime\": {{$timestamp}},\n  \"extraData\": {\n    \"point\": \"START\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/checkpoint-participant",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "checkpoint-participant"
              ]
            },
            "description": "Webhook para recibir datos de checkpoint de participantes (Copernico). Requiere competitionId, type y participantId; copernicoId, rawTime y extraData.point son opcionales."
          }
        }
      ]
    },
    {
      "name": "üîß Utilidades & Testing",
      "item": [
        {
          "name": "Generate Test Data",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\",\n  \"participantsCount\": 10,\n  \"storiesPerParticipant\": 3\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/generate-test-data",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "generate-test-data"
              ]
            },
            "description": "Generar datos de prueba variados (participantes, stories, sponsors)"
          }
        },
        {
          "name": "Create Participant with Stories",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\",\n  \"participantId\": \"test-participant-001\",\n  \"participant\": {\n    \"name\": \"Test\",\n    \"lastName\": \"Participant\",\n    \"dorsal\": \"9999\",\n    \"category\": \"Test\",\n    \"team\": \"Test Team\"\n  },\n  \"stories\": [\n    {\n      \"contentType\": \"ATHLETE_STARTED\",\n      \"description\": \"Participante de prueba iniciando\",\n      \"mediaType\": \"video\",\n      \"fileUrl\": \"https://example.com/video.mp4\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/participants",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "participants"
              ]
            },
            "description": "Crear participante con stories asociadas"
          }
        }
      ]
    },
    {
      "name": "Compartir (Share Counter)",
      "item": [
        {
          "name": "Incrementar Contador de Compartir",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\",\n  \"participantId\": \"{{participantId}}\",\n  \"storyId\": \"{{storyId}}\",\n  \"userId\": \"{{userId}}\",\n  \"shareType\": \"social_media\",\n  \"platform\": \"whatsapp\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/share",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "share"
              ]
            },
            "description": "Incrementa el contador de comparticiones de una historia espec√≠fica. Permite rastrear el tipo de compartici√≥n (social_media, direct_message, copy_link, other) y la plataforma (whatsapp, instagram, facebook, etc.)."
          }
        },
        {
          "name": "Obtener Contador de Comparticiones - Participante",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/shares/count?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&participantId={{participantId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "shares",
                "count"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}",
                  "description": "ID de la carrera (REQUERIDO)"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}",
                  "description": "ID de la app (REQUERIDO)"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}",
                  "description": "ID del evento (REQUERIDO)"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}",
                  "description": "ID del participante (REQUERIDO)"
                }
              ]
            },
            "description": "Obtiene el total de comparticiones de todas las historias de un participante, con desglose por tipo de compartici√≥n y plataforma."
          }
        },
        {
          "name": "Obtener Contador de Comparticiones - Historia Espec√≠fica",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/shares/count?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&participantId={{participantId}}&storyId={{storyId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "shares",
                "count"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}",
                  "description": "ID de la carrera (REQUERIDO)"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}",
                  "description": "ID de la app (REQUERIDO)"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}",
                  "description": "ID del evento (REQUERIDO)"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}",
                  "description": "ID del participante (REQUERIDO)"
                },
                {
                  "key": "storyId",
                  "value": "{{storyId}}",
                  "description": "ID de la historia espec√≠fica (OPCIONAL)"
                }
              ]
            },
            "description": "Obtiene el contador de comparticiones de una historia espec√≠fica, con desglose detallado por tipo y plataforma."
          }
        }
      ]
    },
    {
      "name": "üîê Push Notifications",
      "item": [
        {
          "name": "Register FCM Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\",\n  \"fcmToken\": \"token_real_del_dispositivo\",\n  \"raceId\": \"race-001-madrid-marathon\",\n  \"deviceInfo\": {\n    \"platform\": \"android\",\n    \"deviceId\": \"device-001\",\n    \"appVersion\": \"1.0.0\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/fcm/register-token",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "fcm",
                "register-token"
              ]
            },
            "description": "Registrar token FCM para push notifications espec√≠ficas de una carrera. Requiere userId, fcmToken y raceId."
          }
        },
        {
          "name": "Unregister FCM Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\",\n  \"raceId\": \"race-001-madrid-marathon\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/fcm/unregister-token",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "fcm",
                "unregister-token"
              ]
            },
            "description": "Desregistrar token FCM de un usuario para una carrera espec√≠fica. Requiere userId y raceId."
          }
        },
        {
          "name": "Send Push Notification",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{userId}}\",\n  \"raceId\": \"race-001-madrid-marathon\",\n  \"title\": \"üîî Notificaci√≥n Push\",\n  \"body\": \"Esta es una notificaci√≥n push del sistema\",\n  \"data\": {\n    \"notificationType\": \"manual\",\n    \"timestamp\": \"2024-01-15T10:30:00Z\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/fcm/push-notification",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "fcm",
                "push-notification"
              ]
            },
            "description": "Enviar notificaci√≥n push con filtros: userId (usuario espec√≠fico), raceId (carrera espec√≠fica), userId+raceId (usuario en carrera), o sin filtros (broadcast a todos)."
          }
        },
        {
          "name": "Send Silent Notification (Background Sync)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"silent\": true,\n  \"data\": {\n    \"action\": \"sync_data\",\n    \"dataType\": \"race_updates\",\n    \"syncTimestamp\": \"{{$timestamp}}\",\n    \"priority\": \"background\",\n    \"changes\": \"{\\\"races\\\": [\\\"updated_race_1\\\"], \\\"stories\\\": 3}\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/fcm/push-notification",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "fcm",
                "push-notification"
              ]
            },
            "description": "üîï NOTIFICACI√ìN SILENCIOSA: NO aparece en bandeja, S√ç despierta la app para sincronizaci√≥n en background. Perfecta para actualizar datos sin molestar al usuario. Usar silent: true es la clave."
          }
        },
        {
          "name": "Send Silent Notification - Race Specific",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"raceId\": \"{{raceId}}\",\n  \"silent\": true,\n  \"data\": {\n    \"action\": \"sync_race_data\",\n    \"raceId\": \"{{raceId}}\",\n    \"dataType\": \"race_specific_update\",\n    \"syncTimestamp\": \"{{$timestamp}}\",\n    \"changes\": \"{\\\"leaderboard\\\": \\\"updated\\\", \\\"newStories\\\": 3, \\\"weatherUpdate\\\": \\\"sunny_25c\\\"}\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/fcm/push-notification",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "fcm",
                "push-notification"
              ]
            },
            "description": "üîï NOTIFICACI√ìN SILENCIOSA ESPEC√çFICA DE CARRERA: Sincroniza datos solo para usuarios de una carrera espec√≠fica sin mostrar notificaci√≥n visible."
          }
        },
        {
          "name": "Get FCM Stats",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/fcm/stats",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "fcm",
                "stats"
              ]
            },
            "description": "Obtener estad√≠sticas detalladas de tokens FCM: total de usuarios, tokens por carrera, estad√≠sticas por carrera y notificaciones recientes."
          }
        }
      ]
    },
    {
      "name": "üóëÔ∏è Story Management",
      "item": [
        {
          "name": "DELETE Story - Single (participant)",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/story?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&participantId={{participantId}}&storyId={{storyId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "story"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}"
                },
                {
                  "key": "storyId",
                  "value": "{{storyId}}"
                }
              ]
            },
            "description": "Elimina una historia espec√≠fica y sus subcolecciones. Requiere participantId y storyId."
          }
        },
        {
          "name": "DELETE Stories - Event-wide (no participantId)",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/story?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "story"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                }
              ]
            },
            "description": "Elimina todas las historias del evento (iterando participantes). No enviar participantId para modo event-wide."
          }
        }
      ]
    },
    {
      "name": "üß™ V3 Endpoints",
      "item": [
        {
          "name": "GET Race Events v3 - All",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events-v3?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&limit=10&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events-v3"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "type",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "participantId",
                  "value": "",
                  "disabled": true
                },
                {
                  "key": "audience",
                  "value": "all",
                  "disabled": true
                },
                {
                  "key": "userId",
                  "value": "{{userId}}",
                  "disabled": true
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "Race events v3. Params: raceId/appId/eventId requeridos. Opcionales: type, participantId, audience=all|featured, userId, limit, offset."
          }
        },
        {
          "name": "GET Race Events v3 - Featured o Seguidos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/race-events-v3?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&audience=featured&userId={{userId}}&limit=10&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "race-events-v3"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "audience",
                  "value": "featured"
                },
                {
                  "key": "userId",
                  "value": "{{userId}}"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "Race events v3 filtrado. audience=featured y userId opcional para incluir seguidos."
          }
        },
        {
          "name": "GET Participant v3",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/participant-v3?raceId={{raceId}}&eventId={{eventId}}&participantId={{participantId}}&appId={{appId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "participant-v3"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "participantId",
                  "value": "{{participantId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                }
              ]
            },
            "description": "Participante v3 desde Copernico. Params: raceId, eventId, participantId requeridos; appId opcional."
          }
        },
        {
          "name": "GET Leaderboard v3",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/apps/leaderboard-v3?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&type=overall&limit=20&offset=0",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "apps",
                "leaderboard-v3"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "type",
                  "value": "overall"
                },
                {
                  "key": "gender",
                  "value": "male",
                  "disabled": true
                },
                {
                  "key": "category",
                  "value": "M45",
                  "disabled": true
                },
                {
                  "key": "removeEmpty",
                  "value": "1",
                  "disabled": true
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            },
            "description": "Leaderboard v3 desde Copernico. type=overall|gender|category. gender/category opcionales. removeEmpty solo aplica cuando type=gender o type=category sin filtro."
          }
        },
        {
          "name": "GET Search Participants v3",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/search/participants-v3?raceId={{raceId}}&appId={{appId}}&eventId={{eventId}}&query=Mateo&limit=20",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "search",
                "participants-v3"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                },
                {
                  "key": "appId",
                  "value": "{{appId}}"
                },
                {
                  "key": "eventId",
                  "value": "{{eventId}}"
                },
                {
                  "key": "query",
                  "value": "Mateo"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            },
            "description": "Busqueda v3 desde Copernico /athletes/list.\n\nRespuesta incluye: total (filtrado) y totalCopernico (total crudo de Copernico).\n\nOrden: primero following=true (requiere userId), luego featured=true, luego el resto. Si no env√≠as userId, following siempre es false."
          }
        },
        {
          "name": "GET Config v3",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/config-v3?raceId={{raceId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "config-v3"
              ],
              "query": [
                {
                  "key": "raceId",
                  "value": "{{raceId}}"
                }
              ]
            },
            "description": "Config v3 con publishedRankings (overall/category/gender/attr_*) y maps por evento."
          }
        },
        {
          "name": "POST Follow v3",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"followerId\": \"{{userId}}\",\n  \"followingId\": \"{{participantId}}\",\n  \"raceId\": \"{{raceId}}\",\n  \"appId\": \"{{appId}}\",\n  \"eventId\": \"{{eventId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/follow-v3",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "follow-v3"
              ]
            }
          },
          "description": "Follow v3 con creacion basica del participante."
        },
        {
          "name": "POST Checkpoint Participant v3",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "apiKey",
                "value": "{{webhookApiKey}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"competitionId\": \"{{raceId}}\",\n  \"copernicoId\": \"{{copernicoId}}\",\n  \"participantId\": \"{{participantId}}\",\n  \"type\": \"detection\",\n  \"rawTime\": null,\n  \"extraData\": {\n    \"event\": \"{{eventId}}\",\n    \"point\": \"10K\",\n    \"location\": \"10K\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/checkpoint-participant-v3",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "checkpoint-participant-v3"
              ]
            }
          },
          "description": "Webhook v3 para checkpoints. type=detection|modification. extraData.event/point/location. apiKey requerido. rawTime opcional (ms)."
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "https://liveapigateway-3rt3xwiooa-uc.a.run.app",
      "type": "string"
    },
    {
      "key": "appId",
      "value": "Ryx7YFWobBfGTJqkciCV",
      "type": "string",
      "description": "App ID para la nueva estructura races/apps/events - ACTUALIZADO"
    },
    {
      "key": "raceId",
      "value": "69200553-464c-4bfd-9b35-4ca6ac1f17f5",
      "type": "string",
      "description": "Race ID de prueba - ACTUALIZADO"
    },
    {
      "key": "eventId",
      "value": "Medio Marat√≥n",
      "type": "string",
      "description": "Event ID de prueba - ACTUALIZADO"
    },
    {
      "key": "participantId",
      "value": "1ZZCB42Y",
      "type": "string",
      "description": "Participant ID de prueba - ACTUALIZADO"
    },
    {
      "key": "userId",
      "value": "ca03a740-3bd3-4ade-ac77-161486d2a91c",
      "type": "string",
      "description": "User ID de prueba - ACTUALIZADO"
    },
    {
      "key": "storyId",
      "value": "story-example-123",
      "type": "string"
    },
    {
      "key": "sponsorId",
      "value": "sponsor-001",
      "type": "string"
    },
    {
      "key": "companyId",
      "value": "4f739ee0-93af-11ec-a392-c562749f06e9",
      "type": "string"
    },
    {
      "key": "bundleId",
      "value": "com.live2.app",
      "type": "string"
    },
    {
      "key": "raceName",
      "value": "Sin nombre",
      "type": "string"
    },
    {
      "key": "copernicoId",
      "value": "generali-maraton-malaga-2025",
      "type": "string",
      "description": "Copernico race slug (para endpoints v3)"
    },
    {
      "key": "webhookApiKey",
      "value": "REEMPLAZAR_CON_WEBHOOK_API_KEY",
      "type": "string",
      "description": "API key para webhook checkpoint-participant-v3"
    },
    {
      "key": "nextOffset",
      "value": "10",
      "type": "string",
      "description": "Offset para la siguiente p√°gina (actualizar con pagination.nextOffset de cada respuesta)"
    }
  ]
}